    PolicySet (PS1,in:PS1) ( cb:opo id:OpenAz-TopLevelPolicySet mlev:0)
      Target(PolicySet)
    PolicySet (PS2,in:PS1) ( cb:opo id:TestAzApi-GeneratedPolicySet mlev:1)
      Target(PolicySet)
      Policy (P1,in:PS2) ( cb:ord-po id:TestAzApi-GeneratedPolicy )
        Target(Policy)
          TS (sub-id,"Joe User" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TS (sub-id,"josh" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TS (sub-id,"users.example.com" dt:rfc822 mtId:rf8-eq fnId:! issuer:! mbp:f )
          TS (sub-id,"CN=Rich,OU=Identity Management,O=Oracle,C=US" dt:x500name mtId:x50-eq fnId:! issuer:! mbp:f )
          TR (res-id,"http://www.example.com/toplevel" dt:anyURI mtId:uri-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:C\toplevel" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:///C/toplevel/permissionTest" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
           + (az-res-typ,"java.io.FilePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:///C/toplevel/permissionTest/.*" dt:string mtId:rgx-mt fnId:! issuer:! mbp:f )
           + (az-res-typ,"java.io.FilePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:\\toplevel00" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:\\toplevel01" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          TR (res-id,"file:\\\\toplevel.*\\" dt:string mtId:rgx-mt fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:ReadRule )
          Target(Rule)
            TA (act-id,"Read" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
            TA (act-id,"read" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rule ( ef:Permit id:WriteRule )
          Target(Rule)
            TA (act-id,"write" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
            TA (act-id,"Write" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          Condition(Rule)
            TS (sub-authn,"password" dt:string mtId:str-eq fnId:1&only issuer:orcl-weblogic mbp:f )
        Rule ( ef:Permit id:RoleWriteRule )
          Target(Rule)
            TA (act-id,"write" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
            TA (act-id,"Write" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          Condition(Rule)
            TS (az-sub-role-id,"developer" dt:string mtId:str-eq fnId:1&only issuer:orcl-weblogic mbp:f )
        Rule ( ef:Permit id:CommitRule )
          Target(Rule)
            TA (act-id,"commit" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          Condition(Rule)
            TS (group,"developers" dt:string mtId:str-eq fnId:1&only issuer:admin@users.example.com mbp:f )
        Rule ( ef:Deny id:Final )
          Target(Rule)
        Obligations(Policy)
          Obligation ( fulfillOn:Permit id:LogSuccessfulAccess )
            OA (sub-id,"user" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (res-id,"resource" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (sub-id,"&lt;SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/&gt;" dt:string mtId:! fnId:! issuer:! mbp:f )
          Obligation ( fulfillOn:Deny id:LogDeniedAccess )
            OA (sub-id,"user" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (res-id,"resource" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (act-id,"action" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
    PolicySet (PS3,in:PS1) ( cb:opo id:QueryTest-Policy-Based-PolicySet mlev:1)
      Target(PolicySet)
    PolicySet (PS4,in:PS3) ( cb:do id:QueryTest-User1-PolicySet mlev:2)
      Target(PolicySet)
        TS (sub-id,"User1" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
    PolicySet (PS5,in:PS4) ( cb:opo id:QueryTest-User1-Rule1-PolicySet mlev:3)
      Target(PolicySet)
        TR (res-id,"http://www.example.com/A/B/.*" dt:string mtId:rgx-mt fnId:! issuer:! mbp:f )
         + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        TR (res-id,"/-" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
         + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
      Policy (P2,in:PS5) ( cb:ord-po id:Policy-User1-Rule1 )
        Target(Policy)
          TR (res-id,"http://www.example.com/A/B/.*" dt:string mtId:rgx-mt fnId:! issuer:! mbp:f )
           + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:Final )
          Target(Rule)
        Obligations(Policy)
          Obligation ( fulfillOn:Permit id:LogSuccessfulAccess )
            OA (sub-id,"User1" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (az-res-typ,"test.objects.TestResourcePermission" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
      Policy (P3,in:PS5) ( cb:ord-po id:Policy-User1-Rule1-Query )
        Target(Policy)
          TR (res-id,"/-" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
           + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:Final )
          Target(Rule)
        Obligations(Policy)
          Obligation ( fulfillOn:Permit id:LogSuccessfulAccessQuery )
            OA (sub-id,"User1" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (res-id,"http://www.example.com/A/B/.*" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (az-res-typ,"test.objects.TestResourcePermission" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
    PolicySet (PS6,in:PS4) ( cb:opo id:QueryTest-User1-Rule2-PolicySet mlev:3)
      Target(PolicySet)
      Policy (P4,in:PS6) ( cb:ord-po id:Policy-User1-Rule2 )
        Target(Policy)
          TR (res-id,"http://www.example.com/A/D/.*" dt:string mtId:rgx-mt fnId:! issuer:! mbp:f )
           + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:Final )
          Target(Rule)
        Obligations(Policy)
          Obligation ( fulfillOn:Permit id:LogSuccessfulAccess )
            OA (sub-id,"User1" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (az-res-typ,"test.objects.TestResourcePermission" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
      Policy (P5,in:PS6) ( cb:ord-po id:Policy-User1-Rule2-Query )
        Target(Policy)
          TR (res-id,"/-" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
           + (az-res-typ,"test.objects.TestResourcePermission" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:Final )
          Target(Rule)
        Obligations(Policy)
          Obligation ( fulfillOn:Permit id:LogSuccessfulAccessQuery )
            OA (sub-id,"User1" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (res-id,"http://www.example.com/A/D/.*" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
             + (az-res-typ,"test.objects.TestResourcePermission" dt:anyURI mtId:! fnId:! issuer:! mbp:f )
    PolicySet (PS7,in:PS1) ( cb:opo id:QueryTest-Resource-Based-PolicySet mlev:1)
      Target(PolicySet)
        TR (az-res-typ,"EngineeringServer" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        TR (az-res-typ,"Menu" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        TR (az-res-typ,"FrisBee" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
      Policy (P6,in:PS7) ( cb:ord-po id:Policy-EngineeringServer-Query )
        Target(Policy)
          TR (az-res-typ,"EngineeringServer" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:SubjectRule )
          Target(Rule)
            TS (sub-id,"fred" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
            TR (res-id,"resource-id-EngineeringServer-3" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          Condition(Rule)
        Rule ( ef:Deny id:Final )
          Target(Rule)
      Policy (P7,in:PS7) ( cb:ord-po id:P7-Policy-Menu-Query )
        Target(Policy)
          TR (az-res-typ,"Menu" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Deny id:FinalRule )
          Target(Rule)
      Policy (P8,in:PS7) ( cb:ord-po id:P8-Policy-Frisbee-Query )
        Target(Policy)
          TR (az-res-typ,"FrisBee" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
        Rules(Policy)
        Rule ( ef:Permit id:SubjectRule )
          Target(Rule)
            TS (sub-id,"fred" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
             + (urn:openaz:privilege:frisbee,"throw" dt:string mtId:str-eq fnId:! issuer:orcl-weblogic mbp:t )
            TR (res-id,"resource-id-FrisBee-3" dt:string mtId:str-eq fnId:! issuer:! mbp:f )
          Condition(Rule)
        Rule ( ef:Deny id:FinalRule )
          Target(Rule)
